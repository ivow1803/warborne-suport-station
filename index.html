<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Warborne Above Ashes – Support Planner</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="layout">
    <div class="card">
      <h1>Support Station Planner</h1>
      <p>
        Selecione até cinco Drifters para o Support Station. Os bônus individuais aparecem abaixo
        e a ativação dos Companions é calculada automaticamente.
      </p>

      <div class="toggle-row">
        <span>Modo de bônus:</span>
        <button type="button" id="toggle-max-btn" class="toggle-button active">
          Maximized ON
        </button>
        <span class="muted">Se não houver bônus maximizado, cai no valor normal.</span>
      </div>

      <table class="drifter-grid">
        <thead>
          <tr>
            <th></th>
            <th>Drifter 1</th>
            <th>Drifter 2</th>
            <th>Drifter 3</th>
            <th>Drifter 4</th>
            <th>Drifter 5</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="label">Drifter</td>
            <td>
              <div class="drifter-select-wrap">
                <select id="slot-1" class="drifter-select"></select>
                <button type="button" class="clear-btn" onclick="clearSlot(1)">×</button>
              </div>
            </td>
            <td>
              <div class="drifter-select-wrap">
                <select id="slot-2" class="drifter-select"></select>
                <button type="button" class="clear-btn" onclick="clearSlot(2)">×</button>
              </div>
            </td>
            <td>
              <div class="drifter-select-wrap">
                <select id="slot-3" class="drifter-select"></select>
                <button type="button" class="clear-btn" onclick="clearSlot(3)">×</button>
              </div>
            </td>
            <td>
              <div class="drifter-select-wrap">
                <select id="slot-4" class="drifter-select"></select>
                <button type="button" class="clear-btn" onclick="clearSlot(4)">×</button>
              </div>
            </td>
            <td>
              <div class="drifter-select-wrap">
                <select id="slot-5" class="drifter-select"></select>
                <button type="button" class="clear-btn" onclick="clearSlot(5)">×</button>
              </div>
            </td>
          </tr>
          <tr>
            <td class="label">Buff</td>
            <td id="buff-1" class="buff muted">–</td>
            <td id="buff-2" class="buff muted">–</td>
            <td id="buff-3" class="buff muted">–</td>
            <td id="buff-4" class="buff muted">–</td>
            <td id="buff-5" class="buff muted">–</td>
          </tr>
          <tr>
            <td class="label">Debuff</td>
            <td id="debuff-1" class="debuff muted">–</td>
            <td id="debuff-2" class="debuff muted">–</td>
            <td id="debuff-3" class="debuff muted">–</td>
            <td id="debuff-4" class="debuff muted">–</td>
            <td id="debuff-5" class="debuff muted">–</td>
          </tr>
        </tbody>
      </table>

      <div style="margin-top:8px;">
        <button type="button" onclick="clearAllSelections()" style="background:#1f2933;border:1px solid #4b5563;color:#e5e7eb;border-radius:6px;padding:4px 10px;font-size:12px;cursor:pointer;">
          Limpar todos
        </button>
      </div>

      <div class="footer-note">
        Os Drifters são carregados dos JSON em <code>data/drifters</code>. Atualize-os lá.
      </div>
    </div>

    <div class="card">
      <h2>Companions / Links</h2>
      <p>
        Os efeitos são ativados quando o número necessário de Drifters do grupo está definido nos
        cinco slots acima.
      </p>

      <table class="table-small" id="companion-table">
        <thead>
          <tr>
            <th>Bonus</th>
            <th>Qtd</th>
            <th>Grupo</th>
            <th>Categoria</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <!-- preenchido via JS -->
        </tbody>
      </table>

      <div class="footer-note">
        Os Companions vêm de <code>data/companions_planner.json</code>.
      </div>
    </div>

    <div class="card">
      <h2>Main Drifter</h2>
      <p>Escolha seu Drifter principal para ver os status base (sem aplicar efeitos ainda).</p>
      <div style="margin-top:8px; max-width: 280px;">
        <select id="main-drifter" class="drifter-select"></select>
      </div>
      <div id="main-level-controls" class="level-controls" style="margin-top:8px; display:flex; flex-wrap:wrap; gap:6px; align-items:center;">
        <span id="main-level-label" class="muted">Level: 1</span>
        <div class="level-buttons" style="display:flex; gap:6px; flex-wrap:wrap;">
          <button type="button" class="lvl-btn" data-step="-50">-50</button>
          <button type="button" class="lvl-btn" data-step="-10">-10</button>
          <button type="button" class="lvl-btn" data-step="-5">-5</button>
          <button type="button" class="lvl-btn" data-step="-1">-1</button>
          <button type="button" class="lvl-btn" data-step="1">+1</button>
          <button type="button" class="lvl-btn" data-step="5">+5</button>
          <button type="button" class="lvl-btn" data-step="10">+10</button>
          <button type="button" class="lvl-btn" data-step="50">+50</button>
        </div>
      </div>

      <div id="main-attr-inputs" class="attr-inputs" style="margin-top:10px;">
        <div class="muted" style="margin-bottom:4px;">Override attributes (optional)</div>
        <div style="display:flex; gap:8px; flex-wrap:wrap;">
          <label style="display:flex; align-items:center; gap:4px;">STR
            <input type="number" step="0.1" class="attr-input" data-attr="STR" style="width:80px;" />
          </label>
          <label style="display:flex; align-items:center; gap:4px;">DEX
            <input type="number" step="0.1" class="attr-input" data-attr="DEX" style="width:80px;" />
          </label>
          <label style="display:flex; align-items:center; gap:4px;">INT
            <input type="number" step="0.1" class="attr-input" data-attr="INT" style="width:80px;" />
          </label>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Resumo dos Bônus Ativos</h2>
      <p>
        Visão geral de todos os efeitos atualmente recebidos pelos cinco Drifters escolhidos e
        pelos Companions ativados.
      </p>

      <div class="summary-block">
        <div class="summary-title">Support Station (Drifters)</div>
        <ul id="summary-drifters" class="summary-list"></ul>
      </div>

      <div class="summary-block">
        <div class="summary-title">Companions Ativos</div>
        <ul id="summary-companions" class="summary-list"></ul>
      </div>

      <div class="summary-block">
        <div class="summary-title">Totais combinados</div>
        <ul id="summary-totals" class="summary-list"></ul>
      </div>

      <div class="summary-block">
        <div class="summary-title">Status do Main Drifter</div>
        <button type="button" id="main-stats-sort" class="toggle-button" style="margin-bottom:6px;">
          Ordenar por buff/debuff
        </button>
        <ul id="summary-main-stats" class="summary-list"></ul>
      </div>
    </div>

    <div class="card">
      <h2>Lista de Drifters (Suporte)</h2>
      <p>
        Consulta rápida de todos os Drifters, mostrando Tier, nível e bônus individuais de suporte.
        Quando um Drifter é escolhido em cima, a linha correspondente aqui fica destacada em verde.
      </p>

      <div class="sort-controls">
        <span>Ordenar por:</span>
        <button type="button" class="sort-button active" data-sort="name">Nome</button>
        <button type="button" class="sort-button" data-sort="status">Status</button>
      </div>

      <table class="table-small" id="drifter-table">
        <thead>
          <tr>
            <th>Drifter</th>
            <th>Tier</th>
            <th>LV</th>
            <th>Buff</th>
            <th>Debuff</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <!-- preenchido via JS -->
        </tbody>
      </table>
    </div>
  </div>

  <script src="script.js" defer></script>
</body>
</html>
